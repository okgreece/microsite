{% if microsite.stacked_datasets %}
  {% for dataset in microsite.dataset_set.all %}
    <div class="ui raised segment">
      <iframe src="{{ dataset.embed_url }}" width="100%" height="800" border="0" frameborder="0" seamless="on" style="border: 0px; margin: 0px; padding: 0px;"></iframe>
    </div>
  {% endfor %}
{% endif %}

{% if not microsite.stacked_datasets %}
  <select id="dataset-dropdown" class="ui selection dropdown" ng-model="current_dataset_url">
    {% for dataset in microsite.dataset_set.all %}
      <option value="{{ dataset.embed_url }}" class="item">
        {{ dataset.name }}
      </option>
    {% endfor %}
  </select>

  {% for dataset in microsite.dataset_set.all %}
    <div class="ui raised segment" ng-show="current_dataset_url == '{{ dataset.embed_url }}'">
      {% if dataset.render_from == 'OpenSpending' %}
        <iframe src="{{ dataset.embed_url }}" width="100%" height="800" border="0" frameborder="0" seamless="on" style="border: 0px; margin: 0px; padding: 0px;"></iframe>
      {% endif %}
      {% if dataset.render_from == 'Babbage-ui' %}
        <div ng-controller="VisualizationController as vc">
          <tree-map
            ng-if="vc.datasets[vc.current].isVisible"
            cube="dataset.embed_url"
            state="vc.state"
            endpoint="{{vc.apiUrl}}"
            format-value="vc.formatValue">
          </tree-map>
          <div class="btn btn-primary" ng-click="goBack()">Back</div>
        </div>
      {% endif %}
    </div>
  {% endfor %}
{% endif %}
